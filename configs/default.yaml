seed: 42

device: auto   # auto/cpu/cuda
num_workers: 2

data:
  name: dummy
  batch_size: 32
  train_size: 1024
  val_size: 256
  input_dim: 16
  output_dim: 4

model:
  name: mlp
  hidden_dim: 128

optim:
  lr: 1.0e-3
  weight_decay: 0.0

train:
  epochs: 3
  log_every: 50
  eval_every: 1

ckpt:
  dir: runs
  exp_name: demo
  line_presets:
    forward:
      exp_name: em_forward
      run_id: main
    inverse:
      exp_name: em_inverse
      run_id: main
  save_best: true

metrics:
  track: rmse_mean         # best判定指标：rmse_mean / rel_mean
  lower_is_better: true
  eps: 1.0e-12

amp:
  enabled: false    # CI / CPU 默认 false；GPU 上可改 true 或命令行 --amp
  dtype: fp16       # fp16 或 bf16（cuda 通常 fp16）

scheduler:
  name: none   # none | step | cosine | onecycle

  # step:
  step_size: 10
  gamma: 0.5

  # cosine:
  t_max: 20
  eta_min: 0.0

  # onecycle (steps-based):
  max_lr: 0.001
  pct_start: 0.3
  div_factor: 25.0
  final_div_factor: 10000.0
  anneal_strategy: cos